@page "/home"
@using BattleShip.Models
@using BattleShip.Models.Response

<h3>Home</h3>

<div class="boards-container">
    <div>
        <h5>Player 1 Board</h5>
        <BoardUser Table="UserBoard" />
        <History></History>
    </div>

    <div>
        <h5>Player 2 Board</h5>
        <BoardOpponent Table="OpponentBoard" OnUpdate="(a) => UpdateOpponentBoard(a.UserResult, a.col, a.row)"/>
        <History></History>
        </div>
</div>

<style>
    .boards-container {
        display: flex;
        justify-content: space-around;
    }

    .boards-container > div {
        margin: 10px;
    }
</style>
@code{

    [Parameter]
    public char[,] UserBoard { get; set; } = GameState.Instance.UserBoard;
    [Parameter]
    public char[,] OpponentBoard { get; set; } = GameState.Instance.OpponentBoard;
    
    /*private void UpdateUserBoard(AttackResponse AiAttack)
    {
        var value = 'O';
        switch (AiAttack.Outcome)
        {
            case AttackOutcome.Hit:
                value = 'X';
                break;
            case AttackOutcome.Sunk:
                Console.Write("Sunk");
                break;
            case AttackOutcome.AlreadyAttacked:
                Console.WriteLine($"Error: Player Already Attacked {AiAttack.Coordinates[0]},{AiAttack.Coordinates[1]}");
                return;
        }
        UserBoard[AiAttack.Coordinates[0], AiAttack.Coordinates[1]] = value;
        StateHasChanged();
    }*/

    private void UpdateOpponentBoard(AttackResponse playerAttack, int col, int row)
    {
        Console.Write(playerAttack);
        Console.Write(playerAttack);
        var value = 'O';
        switch (playerAttack.Result)
        {
            case AttackOutcome.Hit:
                value = 'X';
                break;
            case AttackOutcome.Sunk:
                Console.Write("Sunk");
                break;
            case AttackOutcome.AlreadyAttacked:
                Console.WriteLine($"Error: Player Already Attacked {col},{row}");
                return;
        }

        OpponentBoard[col, row] = value;
        StateHasChanged();
        //UpdateUserBoard(AiAttack);
    }
}